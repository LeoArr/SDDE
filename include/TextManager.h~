#ifndef TEXT_MANAGER
#define TEXT_MANAGER

#include <SDL2/SDL_ttf.h>
#include <Logger.h>
#include <ConfigParams.h>
#include <map>
#include <string>

class TextManager {
 public:
  static TextManager* instance() {
    if (_instance == NULL) {
      _instance = new TextManager();
    }
    return _instance;
  }
  ~TextManager() {
    for (auto font : fonts) {
      TTF_CloseFont(font.second);
    }
    fonts.clear();
    TTF_Quit();
  }

  void load(std::string id, std::string fileName, int ptSize = 8) {
    std::string fileLocation = ConfigParams::instance()->get("assets-folder") +
      ConfigParams::instance()->get("fonts-folder") + fileName;
    if (TTF_Font* font = TTF_OpenFont(fileLocation.c_str(), ptSize)) {
      fonts[id] = font;
    }
  }

  TTF_Font* getFont(std::string id) {
    if (fonts.find(id) != fonts.end()) {
      return fonts[id];
    }
    return NULL;
  }

 private:
  TextManager() {
    if (TTF_Init() < 0) {
      Logger::instance()->log("Failed to init text");
    }
  }
  static TextManager* _instance;

  std::map<std::string, TTF_Font*> fonts;
};

#endif
